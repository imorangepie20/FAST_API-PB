# ì¶”ì²œ ì´ìœ  ì„¤ëª… (Recommendation Explainer) ìƒì„¸ ì„¤ëª…

> ì‘ì„±ì¼: 2025-02-07

---

## í˜„ì¬ vs ê°œì„  í›„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [í˜„ì¬] SVM ì¶”ì²œ ê²°ê³¼                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ì¶”ì²œê³¡: Ed Sheeran - Perfect                               â”‚
â”‚  ì ìˆ˜: 0.92                                                 â”‚
â”‚                                                             â”‚
â”‚  â†’ ì™œ ì¶”ì²œí–ˆëŠ”ì§€ ì‚¬ìš©ìëŠ” ëª¨ë¦„                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                          â†“ LLM ì¶”ê°€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [ê°œì„ ] SVM + LLM ì„¤ëª…                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ì¶”ì²œê³¡: Ed Sheeran - Perfect                               â”‚
â”‚  ì ìˆ˜: 0.92                                                 â”‚
â”‚                                                             â”‚
â”‚  ğŸ’¡ "ë‹¹ì‹ ì´ ì¢‹ì•„í•˜ëŠ” ì”ì”í•œ ì–´ì¿ ìŠ¤í‹± ë°œë¼ë“œ ìŠ¤íƒ€ì¼ì´ì—ìš”.    â”‚
â”‚      ìµœê·¼ ë“¤ì€ John Mayer ê³¡ë“¤ê³¼ ë¹„ìŠ·í•œ ê°ì„±ì…ë‹ˆë‹¤."         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ë™ì‘ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SVM ëª¨ë¸   â”‚â”€â”€â”€â”€â–¶â”‚   ë°ì´í„°     â”‚â”€â”€â”€â”€â–¶â”‚   GPT-4o    â”‚
â”‚   ì¶”ì²œ ê²°ê³¼  â”‚     â”‚   ì¡°í•©       â”‚     â”‚   ì„¤ëª… ìƒì„±  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚                    â”‚
       â–¼                    â–¼                    â–¼
  ì¶”ì²œê³¡ + ì ìˆ˜      ì‚¬ìš©ì ì·¨í–¥ +           ìì—°ì–´ ì„¤ëª…
                    ì¶”ì²œê³¡ ì •ë³´
```

---

## êµ¬ì²´ì  ì˜ˆì‹œ

### Step 1: SVMì´ ê³¡ ì¶”ì²œ

```python
# ê¸°ì¡´ SVM ì¶”ì²œ ê²°ê³¼
recommended_track = {
    "artist": "Ed Sheeran",
    "title": "Perfect",
    "score": 0.92,
    "audio_features": {
        "energy": 0.3,
        "valence": 0.6,
        "acousticness": 0.8,
        "tempo": 95
    }
}
```

### Step 2: ì‚¬ìš©ì ì·¨í–¥ ë°ì´í„° ê°€ì ¸ì˜´

```python
# DBì—ì„œ ì‚¬ìš©ì ì·¨í–¥ ì¡°íšŒ
user_preferences = {
    "avg_energy": 0.35,        # í‰ì†Œ ë“£ëŠ” ê³¡ë“¤ì˜ í‰ê· 
    "avg_valence": 0.55,
    "top_genres": ["acoustic", "pop", "ballad"],
    "recent_artists": ["John Mayer", "Coldplay"]
}
```

### Step 3: LLMì—ê²Œ ì„¤ëª… ìš”ì²­

```python
prompt = f"""
ì‚¬ìš©ì ìŒì•… ì·¨í–¥:
- í‰ê·  ì—ë„ˆì§€: 0.35 (ë‚®ìŒ = ì”ì”í•œ ê³¡ ì„ í˜¸)
- í‰ê·  ë°œë„í•¨: 0.55 (ì¤‘ê°„)
- ì„ í˜¸ ì¥ë¥´: acoustic, pop, ballad
- ìµœê·¼ ë“¤ì€ ì•„í‹°ìŠ¤íŠ¸: John Mayer, Coldplay

ì¶”ì²œëœ ê³¡:
- ì•„í‹°ìŠ¤íŠ¸: Ed Sheeran
- ê³¡ëª…: Perfect
- ì—ë„ˆì§€: 0.3 (ë‚®ìŒ)
- ì–´ì¿ ìŠ¤í‹±: 0.8 (ë†’ìŒ)

ì´ ê³¡ì„ ì¶”ì²œí•œ ì´ìœ ë¥¼ ì¹œê·¼í•œ ë§íˆ¬ë¡œ 2ë¬¸ì¥ìœ¼ë¡œ ì„¤ëª…í•´ì¤˜.
"""
```

### Step 4: LLM ì‘ë‹µ

```
"ë‹¹ì‹ ì´ ì¢‹ì•„í•˜ëŠ” ì”ì”í•œ ì–´ì¿ ìŠ¤í‹± ë°œë¼ë“œ ìŠ¤íƒ€ì¼ì´ì—ìš”.
 ìµœê·¼ ë“¤ì€ John Mayer ê³¡ë“¤ê³¼ ë¹„ìŠ·í•œ ê°ì„±ì˜ ê³¡ì…ë‹ˆë‹¤."
```

---

## í•µì‹¬ í¬ì¸íŠ¸

| ì§ˆë¬¸ | ë‹µë³€ |
|------|------|
| **SVMì€ ë­˜ í•˜ë‚˜ìš”?** | ì ìˆ˜(0.92)ë§Œ ê³„ì‚° â†’ "ì¢‹ì•„í•  í™•ë¥ " |
| **LLMì€ ë­˜ í•˜ë‚˜ìš”?** | ì ìˆ˜ë¥¼ **ì‚¬ëŒì´ ì´í•´í•  ìˆ˜ ìˆëŠ” ë§**ë¡œ ë³€í™˜ |
| **ì™œ í•„ìš”í•œê°€ìš”?** | ì‚¬ìš©ìê°€ "ì™œ ì´ ê³¡?"ì„ ì´í•´í•˜ë©´ ì‹ ë¢°ë„â†‘ |

---

## ì‹¤ì œ ì½”ë“œ íë¦„

```python
# 1. ê¸°ì¡´ ì¶”ì²œ API í˜¸ì¶œ
recommendations = await svm_recommend(user_id, tracks)

# 2. ê° ì¶”ì²œê³¡ì— LLM ì„¤ëª… ì¶”ê°€
for track in recommendations:
    explanation = await explain_recommendation(
        track=track,
        user_prefs=get_user_preferences(user_id)
    )
    track["explanation"] = explanation

# 3. í”„ë¡ íŠ¸ì—”ë“œì— ë°˜í™˜
return recommendations
```

---

## êµ¬í˜„ ìœ„ì¹˜

```
fastapi/app/
â”œâ”€â”€ services/
â”‚   â””â”€â”€ llm/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ config.py           # OpenAI API í‚¤ ì„¤ì •
â”‚       â””â”€â”€ explainer.py        # ì¶”ì²œ ì´ìœ  ì„¤ëª… ë¡œì§
â”œâ”€â”€ routers/
â”‚   â””â”€â”€ llm.py                  # /api/llm/explain ì—”ë“œí¬ì¸íŠ¸
â””â”€â”€ models/
    â””â”€â”€ llm.py                  # Request/Response ìŠ¤í‚¤ë§ˆ
```

---

## API ì„¤ê³„

### Request

```python
POST /api/llm/explain
{
    "user_id": 1,
    "track": {
        "artist": "Ed Sheeran",
        "title": "Perfect",
        "audio_features": {
            "energy": 0.3,
            "valence": 0.6,
            "acousticness": 0.8
        }
    }
}
```

### Response

```python
{
    "explanation": "ë‹¹ì‹ ì´ ì¢‹ì•„í•˜ëŠ” ì”ì”í•œ ì–´ì¿ ìŠ¤í‹± ë°œë¼ë“œ ìŠ¤íƒ€ì¼ì´ì—ìš”...",
    "match_score": 0.87
}
```

---

## ë¹„ìš© ì˜ˆì¸¡

- **ëª¨ë¸**: GPT-4o-mini
- **ê°€ê²©**: $0.15 / 1M input tokens, $0.60 / 1M output tokens
- **1íšŒ í˜¸ì¶œ**: ~500 input + ~100 output tokens
- **ë¹„ìš©**: ~$0.0001/call (ì•½ 0.1ì›)
- **1000íšŒ/ì¼**: ~$0.10/day (~130ì›/ì¼)

---

*ì‘ì„±ì¼: 2025-02-07*
